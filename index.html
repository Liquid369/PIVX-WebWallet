<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta content="utf-8" http-equiv="encoding">
    <link rel="shortcut icon" href="assets/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="assets/style/style.css">
  </head>
  <audio controls id="woof" style='display:none;'>
  <source src="assets/woof.mp3" type="audio/mpeg">
  </audio>
  <body>
    <h2>
      <img src='assets/doge.png' onclick="document.getElementById('woof').play();" alt="Doge" style='vertical-align: middle;width:40px;display:inline'>
      Web Wallet
      <div style='float:right'>
        <div id='Debug' style='color:#ffa500'></div>
        <div id='Network' style='color:#ffa500'></div>
      </div>
    </h2>
    <br>
    <div style='display:none;background-color:red' id='outdated'>Warning your version is outdated please update to the newest stable version at the <a href='https://github.com/Luke-Larsen/DogeCashWebWallet/releases'>Github</a></div>
    <div class="tab">
      <button id='keypairclick' class="tablinks" onclick="openTab(event, 'keypair')">Keys</button>
      <button class="tablinks" onclick="openTab(event, 'Transaction')">Create Transaction</button>
      <button class="tablinks" onclick="setIframeSrc();openTab(event, 'WalletData')">Network Data</button>
      <button class="tablinks" onclick="openTab(event, 'Settings');">Settings</button>
    </div>
    <div id="keypair" class="tabcontent">
      <h3>Generate Dogec wallet</h3>
      <div id='importWallet' style='display:none;'>
        <input type="text" id='privateKey' placeholder="Private Key">
        <button onclick="importWallet()">Import wallet</button>
      </div>
      <div id='generateWallet'>
        <button onclick="generateWallet()">Create A New Wallet</button>
      </div>
      <br>
        <button id='wToggle'onclick='toggleWallet()'>Access My Wallet</button>
      <br>
      <br>
      <h4 id='genKeyWarning' style='display:none;'><b>Warning: if you do not save your generated private key you will not have access to the coins associated with that key</b></h4>
      <br>
      <div style='display:none;' id='Privatelabel'>Private:</div><div id='PrivateTxt'></div>
      <br>
      <div id="PrivateQR"></div>
      <br>
      <div style='display:none;' id='Publiclabel'>Public:</div><div id='PublicTxt'></div>
      <br>
      <div id="PublicQR"></div>
    </div>
    <div id="Transaction" class="tabcontent">
      <div class='pullDown' style='clear:both;'>
        <div onclick='toggleDropDown("simpleTransactions")'>Create a Manual Transactions<span style='float:right;'>▼</span></div>
        <div id='simpleTransactions' style='display:block'>
          <label>Address</label>
          <input type="text" id="address1">
          <label>Amount</label>
          <input type="text" id="value1">
          <br>
          <button onclick="createSimpleTransation()">Create Raw Signed Transction</button>
        </div>
      </div>
      <br>
      <div class='pullDown' style='clear:both;'>
        <div onclick='toggleDropDown("advTransactions")'>Create a Manual Transactions<span style='float:right;'>▼</span></div>
        <div id='advTransactions' style='display:none'>
          <h2>Inputs</h2>
          <label>Trx Hash</label>
          <input type="text" id="prevTrxHash">
          <label>Index</label>
          <input type="text" id="index">
          <label>Script</label>
          <input type="text" id="script">
          <h2>Outputs</h2>
          <label>Output Address 1</label>
          <input type="text" id="address1">
          <label>Amount</label>
          <input type="text" id="value1">
          <br/>
          <label>Output address 2</label>
          <input type="text" id="address2">
          <label>Amount</label>
          <input type="text" id="value2">
          <h2>WIF Key</h2>
          <label>key</label>
          <input type="text" id="wif">
          <br/><br/>
          <b>WARNING ANY FUNDS NOT ALLOCATED WILL BE USED AS FEES</b>
          <br>
          <button onclick="createRawTransaction()">Create Raw Signed Transction</button>
          <br/><br/><br/>
          <h2>Signed Raw Transaction</h2>
          <textarea rows="15" cols="70" id="rawTrx"></textarea>
          <h3>Don't understand how this works? <a target='_blank' href='https://github.com/Luke-Larsen/DogeCashWebWallet#transaction'>Tutorial Here</a>
          <h4>Advanced Details: <br>locktime is set to 0, sequence is set to max. SIGHASH_ALL option is chosen for signing raw Transaction.</h4>
        </div>
      </div>
    </div>
    <div id="Settings" class="tabcontent">
        <form action="javascript:setExplorer()">
          <label for="explorer">Choose a explorer:</label>
          <select id="explorer" name="explorer">
            <option value="explorer.dogec.io">https://explorer.dogec.io/</option>
            <option value="custom">custom (In Development)</option>
          </select>
          <br>
          <input type="submit">
      </form>
      <br>
      <button type="submit" onclick='toggleDebug()'>Toggle Debug mode</button>
      <button type="submit" onclick='toggleNetwork()'>Toggle Networking mode</button>
    </div>
    <div id="WalletData" class="tabcontent">
        <div id='networkingNotices'></div>
        <div id='readout' style='display:none'>
          <div style='float:left;'>
            Wallet Details
            <hr>
            Balance: <span id='balance'></span> | Total Received: <span id='totalReceived'></span> | Total Sent: <span id='totalSent'></span>
            <br>
            <div class='pullDown' style='clear:both;'>
              <div onclick='toggleDropDown("Transactions")'>Transactions:<span id='TransactionNumber'>▼</span><span style='float:right;'>▼</span></div>
              <div style='background-color:#D0D0D0; width:100%'><span style='display:none;' id='Transactions'></span></div>
            </div>
          </div>
          <!--Right -->
          <div style='float:right;'>
            Address Response
            <hr>
            <span id='addrStr'></span><br>
            <span id='addrStrQR'></span>
          </div>
          <div class='pullDown' style='clear:both;'>
            <div onclick='toggleDropDown("NetworkingJson")'>Pure json:<span style='float:right;'>▼</span></div>
            <div style='background-color:#D0D0D0; width:100%'><textarea rows="15" cols="50" id="NetworkingJson" style='display:none;font-size:1vw;width:99%;overflow:hidden;background-color:#D0D0D0;'></textarea></div>
          </div>
        </div>
    </div>
    <div class="footer">
      <div style='display:inline;' id='dcfooter'></div>
    </div>
    <script type="text/javascript" src="scripts/libs/crypto-min.js"></script>
     <script type="text/javascript" src="scripts/libs/crypto-sha256.js"></script>
     <script type="text/javascript" src="scripts/libs/crypto-sha256-hmac.js"></script>
     <script type="text/javascript" src="scripts/libs/ripemd160.js"></script>
     <script type="text/javascript" src="scripts/libs/jsbn.js"></script>
     <script type="text/javascript" src="scripts/libs/ellipticcurve.js"></script>
     <script type="text/javascript" src="scripts/libs/script.js"></script>
    <script type="text/javascript" src="scripts/libs/qrcode.js"></script>
    <script type="text/javascript" src="scripts/libs/sha256.js"></script>

    <script type="text/javascript" src="scripts/settings.js"></script>
    <script type="text/javascript" src="scripts/wallet.js"></script>
    <script type="text/javascript" src="scripts/network.js"></script>
    <script type="text/javascript" src="scripts/bitTrx.js"></script>
    <script>
    function toggleWallet(){
      var toggle = document.getElementById("wToggle").innerHTML;
      if(toggle === "Access My Wallet"){
        document.getElementById("generateWallet").style.display = 'none';
        document.getElementById("importWallet").style.display = 'block';
        document.getElementById("wToggle").innerHTML = "Create A New Wallet";
      }else{
        document.getElementById("generateWallet").style.display = 'block';
        document.getElementById("importWallet").style.display = 'none';
        document.getElementById("wToggle").innerHTML = "Access My Wallet";
      }
    }
    function toggleDropDown(id){
      var openClosed = document.getElementById(id).style.display;
      if(openClosed === 'block'){
        document.getElementById(id).style.display = 'none';
      }else{
        document.getElementById(id).style.display = 'block';
      }
    }
    function setIframeSrc(){
      if(networkEnabled){
        if(typeof publicKeyForNetwork !== 'undefined'){
          checkPubKey(); //readout
          document.getElementById("readout").style.display = 'block';
          document.getElementById("networkingNotices").innerHTML = '';
        }else{
          document.getElementById("networkingNotices").innerHTML = 'No public key';
        }
      }else{
        document.getElementById("networkingNotices").innerHTML = 'Network disabled';
      }
    }
    function createSimpleTransation(){
      //simple transaction
      var balance; //Used in showing users how much he can spend
      var trx = bitjs.transaction();
      getUnspentTransactions(trx);
    }
    function createRawTransaction() {
      //advanced transaction creation and signing
      var trx = bitjs.transaction();
      var txid = document.getElementById("prevTrxHash").value;
      var index = document.getElementById("index").value;
      var script = document.getElementById("script").value;
      trx.addinput(txid,index,script);
      var address = document.getElementById("address1").value;
      var value = document.getElementById("value1").value;
      trx.addoutput(address,value);
      var address = document.getElementById("address2").value;
      var value = document.getElementById("value2").value;
      trx.addoutput(address,value);
      var wif = privateKeyForTransactions;
      var textArea = document.getElementById("rawTrx");
      textArea.value = trx.sign(wif,1); //SIGHASH_ALL DEFAULT 1
    }
    function openTab(evt, tabName) {
      var i, tabcontent, tablinks;
      tabcontent = document.getElementsByClassName("tabcontent");
      for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
      }
      tablinks = document.getElementsByClassName("tablinks");
      for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
      }
      document.getElementById(tabName).style.display = "block";
      evt.currentTarget.className += " active";
    }
    document.getElementById("keypairclick").click();
    </script>
  </body>
</html>
